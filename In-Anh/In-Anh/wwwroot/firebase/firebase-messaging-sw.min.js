import{registerVersion as e,_registerComponent as t,_getProvider,getApp as n}from"https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js";class FirebaseError extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,FirebaseError.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ErrorFactory.prototype.create)}}class ErrorFactory{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){var a,t=t[0]||{},n=this.service+"/"+e,e=this.errors[e],e=e?(a=t,e.replace(r,(e,t)=>{var n=a[t];return null!=n?String(n):`<${t}?>`})):"Error",e=this.serviceName+`: ${e} (${n}).`;return new FirebaseError(n,e,t)}}const r=/\{\$([^}]+)}/g;function getModularInstance(e){return e&&e._delegate?e._delegate:e}class Component{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}let o,i;const a=new WeakMap,s=new WeakMap,c=new WeakMap,u=new WeakMap,d=new WeakMap;let l={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return s.get(e);if("objectStoreNames"===t)return e.objectStoreNames||c.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return wrap(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function wrapFunction(n){return n!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(i=i||[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey]).includes(n)?function(...e){return n.apply(unwrap(this),e),wrap(a.get(this))}:function(...e){return wrap(n.apply(unwrap(this),e))}:function(e,...t){t=n.call(unwrap(this),e,...t);return c.set(t,e.sort?e.sort():[e]),wrap(t)}}function transformCachableValue(e){return"function"==typeof e?wrapFunction(e):(e instanceof IDBTransaction&&(i=e,s.has(i)||(t=new Promise((e,t)=>{const n=()=>{i.removeEventListener("complete",a),i.removeEventListener("error",r),i.removeEventListener("abort",r)},a=()=>{e(),n()},r=()=>{t(i.error||new DOMException("AbortError","AbortError")),n()};i.addEventListener("complete",a),i.addEventListener("error",r),i.addEventListener("abort",r)}),s.set(i,t))),n=e,(o=o||[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]).some(e=>n instanceof e)?new Proxy(e,l):e);var i,t,n}function wrap(e){var i,t;return e instanceof IDBRequest?(i=e,(t=new Promise((e,t)=>{const n=()=>{i.removeEventListener("success",a),i.removeEventListener("error",r)},a=()=>{e(wrap(i.result)),n()},r=()=>{t(i.error),n()};i.addEventListener("success",a),i.addEventListener("error",r)})).then(e=>{e instanceof IDBCursor&&a.set(e,i)}).catch(()=>{}),d.set(t,i),t):u.has(e)?u.get(e):((t=transformCachableValue(e))!==e&&(u.set(e,t),d.set(t,e)),t)}const unwrap=e=>d.get(e);function openDB(e,t,{blocked:n,upgrade:a,blocking:r,terminated:i}={}){const o=indexedDB.open(e,t),s=wrap(o);return a&&o.addEventListener("upgradeneeded",e=>{a(wrap(o.result),e.oldVersion,e.newVersion,wrap(o.transaction),e)}),n&&o.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),s.then(e=>{i&&e.addEventListener("close",()=>i()),r&&e.addEventListener("versionchange",e=>r(e.oldVersion,e.newVersion,e))}).catch(()=>{}),s}function deleteDB(e,{blocked:t}={}){e=indexedDB.deleteDatabase(e);return t&&e.addEventListener("blocked",e=>t(e.oldVersion,e)),wrap(e).then(()=>{})}const p=["get","getKey","getAll","getAllKeys","count"],f=["put","add","delete","clear"],g=new Map;function getMethod(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t){if(g.get(t))return g.get(t);const a=t.replace(/FromIndex$/,""),r=t!==a,i=f.includes(a);return a in(r?IDBIndex:IDBObjectStore).prototype&&(i||p.includes(a))?(e=async function(e,...t){e=this.transaction(e,i?"readwrite":"readonly");let n=e.store;return r&&(n=n.index(t.shift())),(await Promise.all([n[a](...t),i&&e.done]))[0]},g.set(t,e),e):void 0}}!function(e){l=e(l)}(a=>({...a,get:(e,t,n)=>getMethod(e,t)||a.get(e,t,n),has:(e,t)=>!!getMethod(e,t)||a.has(e,t)}));const h="@firebase/installations",w=new ErrorFactory("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function isServerError(e){return e instanceof FirebaseError&&e.code.includes("request-failed")}function getInstallationsEndpoint({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function extractAuthTokenInfoFromResponse(e){return{token:e.token,requestStatus:2,expiresIn:(e=e.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()}}async function getErrorFromResponse(e,t){t=(await t.json()).error;return w.create("request-failed",{requestName:e,serverCode:t.code,serverMessage:t.message,serverStatus:t.status})}function getHeaders$1({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function getHeadersWithAuth(e,{refreshToken:t}){e=getHeaders$1(e);return e.append("Authorization","FIS_v2 "+t),e}async function retryIfServerError(e){var t=await e();return 500<=t.status&&t.status<600?e():t}function sleep$1(t){return new Promise(e=>{setTimeout(e,t)})}const y=/^[cdef][\w-]{21}$/;function generateFid(){try{var e=new Uint8Array(17),t=((self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16,n=e,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_").substr(0,22));return y.test(t)?t:""}catch(e){return""}var n}function getKey$1(e){return e.appName+"!"+e.appId}const m=new Map;function fidChanged(e,t){var n,e=getKey$1(e);callFidChangeCallbacks(e,t),e=e,t=t,!b&&"BroadcastChannel"in self&&((b=new BroadcastChannel("[Firebase] FID Change")).onmessage=e=>{callFidChangeCallbacks(e.data.key,e.data.fid)}),(n=b)&&n.postMessage({key:e,fid:t}),0===m.size&&b&&(b.close(),b=null)}function callFidChangeCallbacks(e,t){var n=m.get(e);if(n)for(const e of n)e(t)}let b=null;const v="firebase-installations-store";let k=null;function getDbPromise$1(){return k=k||openDB("firebase-installations-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(v)}})}async function set(e,t){var n=getKey$1(e),a=(await getDbPromise$1()).transaction(v,"readwrite"),r=a.objectStore(v),i=await r.get(n);return await r.put(t,n),await a.done,i&&i.fid===t.fid||fidChanged(e,t.fid),t}async function remove(e){var e=getKey$1(e),t=(await getDbPromise$1()).transaction(v,"readwrite");await t.objectStore(v).delete(e),await t.done}async function update(e,t){var n=getKey$1(e),a=(await getDbPromise$1()).transaction(v,"readwrite"),r=a.objectStore(v),i=await r.get(n),t=t(i);return void 0===t?await r.delete(n):await r.put(t,n),await a.done,!t||i&&i.fid===t.fid||fidChanged(e,t.fid),t}async function getInstallationEntry(a){let r;var e=await update(a.appConfig,e=>{var t,e=clearTimedOutRequest(e||{fid:generateFid(),registrationStatus:0}),n=(t=a,0===(e=e).registrationStatus?navigator.onLine?{installationEntry:n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},registrationPromise:async function(t,n){try{var e=await async function({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const a=getInstallationsEndpoint(e),r=getHeaders$1(e),i=t.getImmediate({optional:!0});if(i){const e=await i.getHeartbeatsHeader();e&&r.append("x-firebase-client",e)}const o={fid:n,authVersion:"FIS_v2",appId:e.appId,sdkVersion:"w:0.6.4"},s={method:"POST",headers:r,body:JSON.stringify(o)},c=await retryIfServerError(()=>fetch(a,s));if(c.ok){const e=await c.json();return{fid:e.fid||n,registrationStatus:2,refreshToken:e.refreshToken,authToken:extractAuthTokenInfoFromResponse(e.authToken)}}throw await getErrorFromResponse("Create Installation",c)}(t,n);return set(t.appConfig,e)}catch(e){throw isServerError(e)&&409===e.customData.serverCode?await remove(t.appConfig):await set(t.appConfig,{fid:n.fid,registrationStatus:0}),e}}(t,n)}:{installationEntry:e,registrationPromise:Promise.reject(w.create("app-offline"))}:1===e.registrationStatus?{installationEntry:e,registrationPromise:waitUntilFidRegistration(t)}:{installationEntry:e});return r=n.registrationPromise,n.installationEntry});return""===e.fid?{installationEntry:await r}:{installationEntry:e,registrationPromise:r}}async function waitUntilFidRegistration(e){let t=await updateInstallationRequest(e.appConfig);for(;1===t.registrationStatus;)await sleep$1(100),t=await updateInstallationRequest(e.appConfig);if(0!==t.registrationStatus)return t;{const{installationEntry:t,registrationPromise:n}=await getInstallationEntry(e);return n||t}}function updateInstallationRequest(e){return update(e,e=>{if(e)return clearTimedOutRequest(e);throw w.create("installation-not-found")})}function clearTimedOutRequest(e){return 1===(t=e).registrationStatus&&t.registrationTime+1e4<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function generateAuthTokenRequest({appConfig:e,heartbeatServiceProvider:t},n){[o,s]=[e,n.fid];const a=getInstallationsEndpoint(o)+`/${s}/authTokens:generate`,r=getHeadersWithAuth(e,n),i=t.getImmediate({optional:!0});var o,s;if(i){const e=await i.getHeartbeatsHeader();e&&r.append("x-firebase-client",e)}const c={installation:{sdkVersion:"w:0.6.4",appId:e.appId}},u={method:"POST",headers:r,body:JSON.stringify(c)},d=await retryIfServerError(()=>fetch(a,u));if(d.ok)return extractAuthTokenInfoFromResponse(await d.json());throw await getErrorFromResponse("Generate Auth Token",d)}async function refreshAuthToken(r,i=!1){let o;var e=await update(r.appConfig,e=>{if(!isEntryRegistered(e))throw w.create("not-registered");var t,n,a=e.authToken;if(!(i||2!==(t=a).requestStatus||(t=t,(n=Date.now())<t.creationTime)||t.creationTime+t.expiresIn<n+36e5))return e;if(1===a.requestStatus)return o=async function(e,t){let n=await updateAuthTokenRequest(e.appConfig);for(;1===n.authToken.requestStatus;)await sleep$1(100),n=await updateAuthTokenRequest(e.appConfig);var a=n.authToken;return 0===a.requestStatus?refreshAuthToken(e,t):a}(r,i),e;{if(!navigator.onLine)throw w.create("app-offline");t=e,n={requestStatus:1,requestTime:Date.now()};const i=Object.assign(Object.assign({},t),{authToken:n});return o=async function(t,n){try{var e=await generateAuthTokenRequest(t,n),a=Object.assign(Object.assign({},n),{authToken:e});return await set(t.appConfig,a),e}catch(e){throw!isServerError(e)||401!==e.customData.serverCode&&404!==e.customData.serverCode?(a=Object.assign(Object.assign({},n),{authToken:{requestStatus:0}}),await set(t.appConfig,a)):await remove(t.appConfig),e}}(r,i),i}});return o?await o:e.authToken}function updateAuthTokenRequest(e){return update(e,e=>{if(isEntryRegistered(e))return 1===(t=e.authToken).requestStatus&&t.requestTime+1e4<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;throw w.create("not-registered");var t})}function isEntryRegistered(e){return void 0!==e&&2===e.registrationStatus}async function getToken(e,t=!1){var n=e;return(n=(await getInstallationEntry(n)).registrationPromise)&&await n,await 0,(await refreshAuthToken(e,t)).token}function getMissingValueError$1(e){return w.create("missing-app-config-values",{valueName:e})}const publicFactory=e=>{e=e.getProvider("app").getImmediate();return{app:e,appConfig:function(e){if(!e||!e.options)throw getMissingValueError$1("App Configuration");if(!e.name)throw getMissingValueError$1("App Name");for(const t of["projectId","apiKey","appId"])if(!e.options[t])throw getMissingValueError$1(t);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(e),heartbeatServiceProvider:_getProvider(e,"heartbeat"),_delete:()=>Promise.resolve()}},internalFactory=e=>{const t=e.getProvider("app").getImmediate(),n=_getProvider(t,"installations").getImmediate();return{getId:()=>async function(e){var{installationEntry:t,registrationPromise:n}=await getInstallationEntry(e);return(n||refreshAuthToken(e)).catch(console.error),t.fid}(n),getToken:e=>getToken(n,e)}},I=(t(new Component("installations",publicFactory,"PUBLIC")),t(new Component("installations-internal",internalFactory,"PRIVATE")),e(h,"0.6.4"),e(h,"0.6.4","esm2017"),"BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4");var T,S;function arrayToBase64(e){e=new Uint8Array(e);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function base64ToArray(e){var e=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;++e)n[e]=t.charCodeAt(e);return n}!function(e){e[e.DATA_MESSAGE=1]="DATA_MESSAGE",e[e.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"}(T=T||{}),function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(S=S||{});const E="firebase-messaging-store";let C=null;function getDbPromise(){return C=C||openDB("firebase-messaging-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(E)}})}async function dbGet(e){const t=getKey(e),n=await getDbPromise(),a=await n.transaction(E).objectStore(E).get(t);if(a)return a;{const t=await async function(r){if("databases"in indexedDB){const r=(await indexedDB.databases()).map(e=>e.name);if(!r.includes("fcm_token_details_db"))return null}let i=null;return(await openDB("fcm_token_details_db",5,{upgrade:async(e,t,n,a)=>{if(!(t<2)&&e.objectStoreNames.contains("fcm_token_object_Store")){var e=a.objectStore("fcm_token_object_Store"),a=await e.index("fcmSenderId").get(r);if(await e.clear(),a)if(2===t){const r=a;r.auth&&r.p256dh&&r.endpoint&&(i={token:r.fcmToken,createTime:null!=(e=r.createTime)?e:Date.now(),subscriptionOptions:{auth:r.auth,p256dh:r.p256dh,endpoint:r.endpoint,swScope:r.swScope,vapidKey:"string"==typeof r.vapidKey?r.vapidKey:arrayToBase64(r.vapidKey)}})}else if(3===t){const r=a;i={token:r.fcmToken,createTime:r.createTime,subscriptionOptions:{auth:arrayToBase64(r.auth),p256dh:arrayToBase64(r.p256dh),endpoint:r.endpoint,swScope:r.swScope,vapidKey:arrayToBase64(r.vapidKey)}}}else if(4===t){const r=a;i={token:r.fcmToken,createTime:r.createTime,subscriptionOptions:{auth:arrayToBase64(r.auth),p256dh:arrayToBase64(r.p256dh),endpoint:r.endpoint,swScope:r.swScope,vapidKey:arrayToBase64(r.vapidKey)}}}}}})).close(),await deleteDB("fcm_token_details_db"),await deleteDB("fcm_vapid_details_db"),await deleteDB("undefined"),function(e){var t;if(e&&e.subscriptionOptions)return t=e["subscriptionOptions"],"number"==typeof e.createTime&&0<e.createTime&&"string"==typeof e.token&&0<e.token.length&&"string"==typeof t.auth&&0<t.auth.length&&"string"==typeof t.p256dh&&0<t.p256dh.length&&"string"==typeof t.endpoint&&0<t.endpoint.length&&"string"==typeof t.swScope&&0<t.swScope.length&&"string"==typeof t.vapidKey&&0<t.vapidKey.length}(i)?i:null}(e.appConfig.senderId);if(t)return await dbSet(e,t),t}}async function dbSet(e,t){var e=getKey(e),n=(await getDbPromise()).transaction(E,"readwrite");return await n.objectStore(E).put(t,e),await n.done,t}function getKey({appConfig:e}){return e.appId}const D=new ErrorFactory("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});async function requestDeleteToken(e,t){var n={method:"DELETE",headers:await getHeaders(e)};try{var a=await(await fetch(getEndpoint(e.appConfig)+"/"+t,n)).json();if(a.error){const e=a.error.message;throw D.create("token-unsubscribe-failed",{errorInfo:e})}}catch(e){throw D.create("token-unsubscribe-failed",{errorInfo:null==e?void 0:e.toString()})}}function getEndpoint({projectId:e}){return`https://fcmregistrations.googleapis.com/v1/projects/${e}/registrations`}async function getHeaders({appConfig:e,installations:t}){t=await t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":"FIS "+t})}function getBody({p256dh:e,auth:t,endpoint:n,vapidKey:a}){n={web:{endpoint:n,auth:t,p256dh:e}};return a!==I&&(n.web.applicationPubKey=a),n}async function getTokenInternal(e){o=e.swRegistration,s=e.vapidKey;var t,n,a,r,i,o=await(await o.pushManager.getSubscription()||o.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:base64ToArray(s)})),s={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:o.endpoint,auth:arrayToBase64(o.getKey("auth")),p256dh:arrayToBase64(o.getKey("p256dh"))},o=await dbGet(e.firebaseDependencies);if(o){if(t=o.subscriptionOptions,a=(n=s).vapidKey===t.vapidKey,r=s.endpoint===t.endpoint,i=s.auth===t.auth,n=s.p256dh===t.p256dh,a&&r&&i&&n)return Date.now()>=o.createTime+6048e5?async function(e,t){try{var n=await async function(e,t){const n=await getHeaders(e),a=getBody(t.subscriptionOptions),r={method:"PATCH",headers:n,body:JSON.stringify(a)};let i;try{const n=await fetch(getEndpoint(e.appConfig)+"/"+t.token,r);i=await n.json()}catch(e){throw D.create("token-update-failed",{errorInfo:null==e?void 0:e.toString()})}if(i.error){const e=i.error.message;throw D.create("token-update-failed",{errorInfo:e})}if(i.token)return i.token;throw D.create("token-update-no-token")}(e.firebaseDependencies,t),a=Object.assign(Object.assign({},t),{token:n,createTime:Date.now()});return await dbSet(e.firebaseDependencies,a),n}catch(t){throw await deleteTokenInternal(e),t}}(e,{token:o.token,createTime:Date.now(),subscriptionOptions:s}):o.token;try{await requestDeleteToken(e.firebaseDependencies,o.token)}catch(e){console.warn(e)}}else;return getNewToken(e.firebaseDependencies,s)}async function deleteTokenInternal(e){var t,n=await dbGet(e.firebaseDependencies),n=(n&&(await requestDeleteToken(e.firebaseDependencies,n.token),n=getKey(n=e.firebaseDependencies),await(t=(await getDbPromise()).transaction(E,"readwrite")).objectStore(E).delete(n),await t.done),await e.swRegistration.pushManager.getSubscription());return!n||n.unsubscribe()}async function getNewToken(e,t){t={token:await async function(e,t){var n=await getHeaders(e),t=getBody(t),n={method:"POST",headers:n,body:JSON.stringify(t)};let a;try{const t=await fetch(getEndpoint(e.appConfig),n);a=await t.json()}catch(e){throw D.create("token-subscribe-failed",{errorInfo:null==e?void 0:e.toString()})}if(a.error){const e=a.error.message;throw D.create("token-subscribe-failed",{errorInfo:e})}if(a.token)return a.token;throw D.create("token-subscribe-no-token")}(e,t),createTime:Date.now(),subscriptionOptions:t};return await dbSet(e,t),t.token}async function stageLog(e,t){t=t,n=await e.firebaseDependencies.installations.getId(),a={},t.from&&(a.project_number=t.from),t.fcmMessageId&&(a.message_id=t.fcmMessageId),a.instance_id=n,t.notification?a.message_type=T.DISPLAY_NOTIFICATION.toString():a.message_type=T.DATA_MESSAGE.toString(),a.sdk_platform=3..toString(),a.package_name=self.origin.replace(/(^\w+:|^)\/\//,""),t.collapse_key&&(a.collapse_key=t.collapse_key),a.event=1..toString(),null!=(n=t.fcmOptions)&&n.analytics_label&&(a.analytics_label=null==(n=t.fcmOptions)?void 0:n.analytics_label);var n,a,t=a;n=e,a=t,(e={}).event_time_ms=Math.floor(Date.now()).toString(),e.source_extension_json_proto3=JSON.stringify(a),n.logEvents.push(e)}function _mergeStrings(t,n){var a=[];for(let e=0;e<t.length;e++)a.push(t.charAt(e)),e<n.length&&a.push(n.charAt(e));return a.join("")}async function onPush(e,t){var n=function({data:e}){if(!e)return null;try{return e.json()}catch(e){return null}}(e);if(n){t.deliveryMetricsExportedToBigQueryEnabled&&await stageLog(t,n);var a,r,i,o,s,e=await getClientList();if(e.some(e=>"visible"===e.visibilityState&&!e.url.startsWith("chrome-extension://"))){var c=n;c.isFirebaseMessaging=!0,c.messageType=S.PUSH_RECEIVED;for(const u of e)u.postMessage(c)}else if(n.notification&&(e=n,(s=Object.assign({},e.notification)).data={FCM_MSG:e},s=(e=s).actions,o=Notification.maxActions,s&&o&&s.length>o&&console.warn(`This browser only supports ${o} actions. The remaining actions will not be displayed.`),await self.registration.showNotification(null!=(s=e.title)?s:"",e)),t&&t.onBackgroundMessageHandler){s={from:(o=n).from,collapseKey:o.collapse_key,messageId:o.fcmMessageId},n=s,(r=o).notification&&(n.notification={},(i=r.notification.title)&&(n.notification.title=i),(i=r.notification.body)&&(n.notification.body=i),(i=r.notification.image)&&(n.notification.image=i),i=r.notification.icon)&&(n.notification.icon=i),r=s,(n=o).data&&(r.data=n.data),i=s,((r=o).fcmOptions||null!=(a=r.notification)&&a.click_action)&&(i.fcmOptions={},(a=null!=(a=null==(a=r.fcmOptions)?void 0:a.link)?a:null==(a=r.notification)?void 0:a.click_action)&&(i.fcmOptions.link=a),r=null==(a=r.fcmOptions)?void 0:a.analytics_label)&&(i.fcmOptions.analyticsLabel=r);const e=s;"function"==typeof t.onBackgroundMessageHandler?await t.onBackgroundMessageHandler(e):t.onBackgroundMessageHandler.next(e)}}}async function onNotificationClick(t){var n=null==(n=null==(n=t.notification)?void 0:n.data)?void 0:n.FCM_MSG;if(n&&!t.action){t.stopImmediatePropagation(),t.notification.close();t=(r=null!=(r=null==(r=(t=n).fcmOptions)?void 0:r.link)?r:null==(r=t.notification)?void 0:r.click_action)||("object"==typeof(r=t.data)&&r&&"google.c.a.c_id"in r?self.location.origin:null);if(t){var a,r=new URL(t,self.location.href),e=new URL(self.location.origin);if(r.host===e.host){let e=await async function(e){const t=await getClientList();for(const n of t){const t=new URL(n.url,self.location.href);if(e.host===t.host)return n}return null}(r);return e?e=await e.focus():(e=await self.clients.openWindow(t),a=3e3,await new Promise(e=>{setTimeout(e,a)})),e?(n.messageType=S.NOTIFICATION_CLICKED,n.isFirebaseMessaging=!0,e.postMessage(n)):void 0}}}}function getClientList(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function getMissingValueError(e){return D.create("missing-app-config-values",{valueName:e})}_mergeStrings("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),_mergeStrings("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class MessagingService{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;var a=function(e){if(!e||!e.options)throw getMissingValueError("App Configuration Object");if(!e.name)throw getMissingValueError("App Name");var t=e["options"];for(const e of["projectId","apiKey","appId","messagingSenderId"])if(!t[e])throw getMissingValueError(e);return{appName:e.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:a,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}const SwMessagingFactory=e=>{const t=new MessagingService(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return self.addEventListener("push",e=>{e.waitUntil(onPush(e,t))}),self.addEventListener("pushsubscriptionchange",e=>{e.waitUntil(async function(e,t){var e=e["newSubscription"];e?(e=await dbGet(t.firebaseDependencies),await deleteTokenInternal(t),t.vapidKey=null!=(e=null==(e=null==e?void 0:e.subscriptionOptions)?void 0:e.vapidKey)?e:I,await getTokenInternal(t)):await deleteTokenInternal(t)}(e,t))}),self.addEventListener("notificationclick",e=>{e.waitUntil(onNotificationClick(e))}),t};async function isSwSupported(){return function(){try{return"object"==typeof indexedDB}catch(e){return!1}}()&&await new Promise((t,n)=>{try{let e=!0;const a="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(a);r.onsuccess=()=>{r.result.close(),e||self.indexedDB.deleteDatabase(a),t(!0)},r.onupgradeneeded=()=>{e=!1},r.onerror=()=>{var e;n((null==(e=r.error)?void 0:e.message)||"")}}catch(t){n(t)}})&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function getMessagingInSw(e=n()){return isSwSupported().then(e=>{if(!e)throw D.create("unsupported-browser")},e=>{throw D.create("indexed-db-unsupported")}),_getProvider(getModularInstance(e),"messaging-sw").getImmediate()}function onBackgroundMessage(e,t){var n=e=getModularInstance(e),e=t;if(void 0!==self.document)throw D.create("only-available-in-sw");return n.onBackgroundMessageHandler=e,()=>{n.onBackgroundMessageHandler=null}}function experimentalSetDeliveryMetricsExportedToBigQueryEnabled(e,t){e=getModularInstance(e),e.deliveryMetricsExportedToBigQueryEnabled=t}t(new Component("messaging-sw",SwMessagingFactory,"PUBLIC"));export{experimentalSetDeliveryMetricsExportedToBigQueryEnabled,getMessagingInSw as getMessaging,isSwSupported as isSupported,onBackgroundMessage};